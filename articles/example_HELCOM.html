<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="harsat">
<title>HELCOM example usage • harsat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="HELCOM example usage">
<meta property="og:description" content="harsat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">harsat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/harsat.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data file management</h6>
    <a class="dropdown-item" href="../articles/file-management.html">File locations</a>
    <a class="dropdown-item" href="../articles/reference-file-formats.html">Reference file formats</a>
    <a class="dropdown-item" href="../articles/external-file-format.html">External file format</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Examples</h6>
    <a class="dropdown-item" href="../articles/example_HELCOM.html">HELCOM (read first)</a>
    <a class="dropdown-item" href="../articles/example_OSPAR.html">OSPAR</a>
    <a class="dropdown-item" href="../articles/example_external_data.html">AMAP external data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Additional resources</h6>
    <a class="dropdown-item" href="../articles/datasets.html">Datasets</a>
    <a class="dropdown-item" href="../articles/report-template.html">Report template</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/osparcomm/HARSAT/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>HELCOM example usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/osparcomm/HARSAT/blob/HEAD/vignettes/example_HELCOM.Rmd" class="external-link"><code>vignettes/example_HELCOM.Rmd</code></a></small>
      <div class="d-none name"><code>example_HELCOM.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette shows how to do an assessment (mostly) following the
approach taken in HELCOM HOLAS3.</p>
<p>The data were extracted from the ICES data base using the XHAT
facilities on the <a href="https://dome.ices.dk/api/swagger/index.html" class="external-link">ICES webservice</a>.
The data were extracted on 28 August 2023 and were filtered using
is_helcom_area = TRUE anad maxYear = 2020. The data were subsequently
reduced in size to make them more manageable for this example.
<strong>The data have not been scrutinised by data assessors so their
use, and the results below, must be treated as illustrative only; in
particular, they should not be used for any formal
reporting</strong>.</p>
<p>There are two exceptions to the HOLAS3 approach. First, imposex data
are not assessed here - these have an additional level of complexity
that will be explained in a subsequent vignette (not written yet).
Second, the method for dealing with ‘initial’ data, unique to HELCOM,
has not been implemented (this is not yet available in harsat).</p>
<p>We’ll begin with contaminants in water which are the simplest data to
assess. We’ll then move on to sediment and biota which have more
features to consider.</p>
<p>But before we get to any of that, we need to set up the environment.
First, load the <code>harsat</code> library (let’s assume that you have
already installed it, as covered in the <a href="/harsat.html">Getting
Started</a> guide).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/osparcomm/HARSAT" class="external-link">harsat</a></span><span class="op">)</span></span></code></pre></div>
<p>We set up our main directory to find the data files. If you use your
own data files, you will need to point to a directory containing a copy.
We usually do this by putting our data files in a directory
<code>data</code>, and information files in a directory
<code>information</code>, but you can use any directory for these.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">working.directory</span> <span class="op">&lt;-</span> <span class="st">'/Users/stuart/git/HARSAT'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="water-assessment">Water assessment<a class="anchor" aria-label="anchor" href="#water-assessment"></a>
</h2>
<p>First, we use <code><a href="../reference/read_data.html">read_data()</a></code> to read in the contaminant
data, the station dictionary, and two important reference tables: the
determinand and threshold reference tables. There are several things to
note about the function call:</p>
<ul>
<li>
<code>purpose = "HELCOM"</code> means that the assessment
configuration is set to mirror that of the HOLAS3 assessment. You can
change the assessment configuration in many ways using the control
argument, but that is not explained here.<br>
</li>
<li>
<code>data_dir</code> identifies the directory storing the
contaminant data (<code>water.txt</code>) and station dictionary
(<code>stations.txt</code>). Using <code>file.path</code> prevents any
difficulties using forward or backward slashes when writing file
paths.</li>
<li>
<code>info_dir</code> identifies the directory storing the reference
tables. These must be named <code>determinand.csv</code> and
<code>thresholds_water.csv</code>. The determinand table identifies
which determinands are going to be assessed. If there are no thresholds,
then there doesn’t need to be a file called
<code>thresholds_water.csv</code>.</li>
<li>you don’t have to specify the extraction date, but it can help to
keep track of things.</li>
</ul>
<p>As well as reading in the contaminant data and station dictionary,
the function matches each record in the contaminant data to a station in
the station dictionary. The process for doing this is quite complicated
(and it can take a few minutes to run) and we don’t go into details
here.</p>
<p>Finally, a message is printed saying that the argument
<code>max_year</code> is set to 2020. (This is as it should be since we
set <code>maxYear</code> to be 2020 in the data extraction.) But an
important consequence is that a contaminant time series will only be
assessed if it has some data in the period 2015 to 2020 (i.e. in the
last six monitoring years).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">water_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span></span>
<span>  compartment <span class="op">=</span> <span class="st">"water"</span>, </span>
<span>  purpose <span class="op">=</span> <span class="st">"HELCOM"</span>,                               </span>
<span>  contaminants <span class="op">=</span> <span class="st">"water.txt"</span>, </span>
<span>  stations <span class="op">=</span> <span class="st">"stations.txt"</span>, </span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"data"</span>, <span class="st">"example_HELCOM"</span><span class="op">)</span>,</span>
<span>  info_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"information"</span>, <span class="st">"HELCOM_2023"</span><span class="op">)</span>, </span>
<span>  extraction <span class="op">=</span> <span class="st">"2023/08/23"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Found in path determinand.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv </span></span>
<span><span class="co">#&gt; Found in path species.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/species.csv </span></span>
<span><span class="co">#&gt; Found in path thresholds_water.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_water.csv </span></span>
<span><span class="co">#&gt; Found in package method_extraction.csv /Users/stuart/git/HARSAT/inst/information/method_extraction.csv </span></span>
<span><span class="co">#&gt; Found in package pivot_values.csv /Users/stuart/git/HARSAT/inst/information/pivot_values.csv </span></span>
<span><span class="co">#&gt; Found in package matrix.csv /Users/stuart/git/HARSAT/inst/information/matrix.csv </span></span>
<span><span class="co">#&gt; Found in package imposex.csv /Users/stuart/git/HARSAT/inst/information/imposex.csv </span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv': 'ed6c2f076d852976e23eab797bd16164'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/matrix.csv': '9ba2731a7d90accddac659025835a6e4'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_water.csv': '599000609710f7a53450f16fef814d1c'</span></span>
<span><span class="co">#&gt; Reading station dictionary from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt': 'ada1ffa58215843e8e4d5f4d74f5e21e'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reading contaminant and effects data from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/water.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/water.txt': 'd229a93b6e1c8b37008d375365488db4'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matching data with station dictionary</span></span>
<span><span class="co">#&gt;  - restricting to stations in these convention areas: HELCOM </span></span>
<span><span class="co">#&gt;  - no restriction of stations by data type</span></span>
<span><span class="co">#&gt;  - no restriction of stations by purpose of monitoring</span></span>
<span><span class="co">#&gt;  - no restriction of data by program governance</span></span>
<span><span class="co">#&gt;  - no restriction of stations by program governance</span></span>
<span><span class="co">#&gt;  - matching 10846 records by coordinates</span></span>
<span><span class="co">#&gt;  - matching 0 records by station name</span></span>
<span><span class="co">#&gt;  - 10746 of 10846 records have been matched to a station</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Argument max_year taken to be the maximum year in the data: 2020</span></span></code></pre></div>
<p>We next simplify the data so that they are in the correct format for
running the assessment. This also involves deleting some data that do
not meet the conditions for the assessment.</p>
<p>Notice that a message appears about ‘oddities’. Both tidy_data and
create_timeseries (the next function call) do a lot of checking of the
data and strange values are written to the oddities folder for you to
have a look at. This is in the hope that, if there are errors, they will
get corrected and resubmitted to the ICES database. It turns out there
are no strange value at this stage, but there are in the step that
follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">water_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_data.html">tidy_data</a></span><span class="op">(</span><span class="va">water_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/water' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/water_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 4071 records from data flagged for deletion. Possible reasons are:</span></span>
<span><span class="co">#&gt;  - vflag = suspect</span></span>
<span><span class="co">#&gt;  - upper depth &gt;5.5m</span></span>
<span><span class="co">#&gt;  - filtration missing</span></span>
<span><span class="co">#&gt;  - matrix = 'SPM'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 88 records from data that have no valid station code</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 13667 stations that are not associated with any data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning station dictionary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning contaminant and biological effects data</span></span></code></pre></div>
<p>We now do some more data cleaning and then group the data into time
series. Each time series consists of measurements of a single
determinand at a single monitoring station. Measurements in filtered and
unfiltered samples are split into different time series.</p>
<p>The <code>determinands.control</code> argument in important to know
about since it allows related determinands to be processed in various
ways. Here, it is just used for PFOS and its linear and branched
components N-PFOS and BR-PFOS. PFOS measurements can be sumbitted as
PFOS (the sum of the two components) or as N-PFOS and BR-PFOs (the
individual components). The <code>determinands.control</code> argument
below tells the code to sum records of N-PFOS and BR-PFOS from the same
sample and relabel them as PFOS. There are more complicated examples of
the use of <code>determinands.control</code> in the sediment and biota
examples below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">water_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_timeseries.html">create_timeseries</a></span><span class="op">(</span></span>
<span>  <span class="va">water_data</span>,</span>
<span>  determinands.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    PFOS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N-PFOS"</span>, <span class="st">"BR-PFOS"</span><span class="op">)</span>, action <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/water' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/water_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning data</span></span>
<span><span class="co">#&gt;    Dropping stations with no data between 2015 and 2020</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'basis': see basis_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'unit': see unit_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'value': see value_queries.csv</span></span>
<span><span class="co">#&gt;    Non-positive detection limits: see non_positive_det_limits.csv</span></span>
<span><span class="co">#&gt;    Censoring codes D and Q inconsistent with respective limits: see censoring_codes_inconsistent.csv</span></span>
<span><span class="co">#&gt;    Detection limit higher than data: see detection_limit_high.csv</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Creating time series data</span></span>
<span><span class="co">#&gt;    Converting data to appropriate basis for statistical analysis</span></span>
<span><span class="co">#&gt;    Dropping groups of compounds / stations with no data between 2015 and 2020</span></span></code></pre></div>
<p>If you want to see a list of all the time series, then you can run
code along the following lines:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_timeseries.html">get_timeseries</a></span><span class="op">(</span><span class="va">water_timeseries</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> </span>
<span><span class="co">#&gt;    station_code station_name   country determinand filtration subseries basis</span></span>
<span><span class="co">#&gt; 1         11241         64A2 Lithuania          CD   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 2         11241         64A2 Lithuania          PB   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 3         11241         64A2 Lithuania        PFOS unfiltered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 4         11241         64A2 Lithuania       TBSN+ unfiltered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 5         12896         AUDF   Estonia          CD   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 6         12896         AUDF   Estonia          PB   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 7         12896         AUDF   Estonia        PFOS unfiltered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 8         12896         AUDF   Estonia       TBSN+ unfiltered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 9          2144      OMMVUW4   Germany          CD   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt; 10         2144      OMMVUW4   Germany          PB   filtered      &lt;NA&gt;     W</span></span>
<span><span class="co">#&gt;    unit</span></span>
<span><span class="co">#&gt; 1  ug/l</span></span>
<span><span class="co">#&gt; 2  ug/l</span></span>
<span><span class="co">#&gt; 3  ng/l</span></span>
<span><span class="co">#&gt; 4  ng/l</span></span>
<span><span class="co">#&gt; 5  ug/l</span></span>
<span><span class="co">#&gt; 6  ug/l</span></span>
<span><span class="co">#&gt; 7  ng/l</span></span>
<span><span class="co">#&gt; 8  ng/l</span></span>
<span><span class="co">#&gt; 9  ug/l</span></span>
<span><span class="co">#&gt; 10 ug/l</span></span></code></pre></div>
<p>At last it is time to run the assessment. You need to specify which
thresholds to use, otherwise the code will not use any of them. For
water there is only the EQS, but you still need to specify it. Look at
the threshold reference table to see what is available if you are
unsure. Note that AC stands for Assessment Criteria which is what
thresholds are often called. The parallel argument tells the code to use
parallel processing. This usually speeds things up considerably. The
assessment took about 1.5 minutes to run on my laptop.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">water_assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_assessment.html">run_assessment</a></span><span class="op">(</span></span>
<span>  <span class="va">water_timeseries</span>, </span>
<span>  AC <span class="op">=</span> <span class="st">"EQS"</span>, </span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting up clusters: be patient, it can take a while!</span></span></code></pre></div>
<p>We now need to check whether there were any convergence issues. Lack
of convergence only rarely occurs, but when it does it is typically
because there are errors in the data (e.g. reported in incorrect units)
or because there are outliers, so the best thing to do is first check
your data. However, convergence can also be difficult if there are a lot
of less-than measurements in the time series. Describing how to tweak
the control arguments to get convergence is beyond the scope of this
vignette (need to write another vignette to discuss this). Fortunately,
there were no convergence issues here.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_assessment.html">check_assessment</a></span><span class="op">(</span><span class="va">water_assessment</span><span class="op">)</span></span>
<span><span class="co">#&gt; All assessment models have converged</span></span></code></pre></div>
<p>It is time to look at the results! We can plot the data for each time
series along with the fitted model (see vignette for external data) or
print a table giving summary information about the assessment of each
time series. But first, we may need to create an output directory.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary.dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"output"</span>, <span class="st">"example_HELCOM"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">summary.dir</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">summary.dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Now that we have an output directory, we can write the summary table
to that directory. Of course, you can choose any directory to write to
here, so long as you are sure it exists.</p>
<p>The code below prints out a CSV file giving summary information about
the assessment of each time series. This includes:</p>
<ul>
<li>meta-data such as the monitoring location and number of years of
data for each time series</li>
<li>the fitted values in the last monitoring year with associated upper
one-sided 95% confidence limits</li>
<li>the trend assessments (p-values and trend estimates)</li>
<li>the status assessments (if there any thresholds)</li>
<li>(optionally) a symbology summarising the trend (shape) and status
(colour) of each time series</li>
</ul>
<p>This function is being actively developed and the function arguments
are likely to evolve, so we’ll leave their explanation for the next
release.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_summary_table.html">write_summary_table</a></span><span class="op">(</span></span>
<span>  <span class="va">water_assessment</span>,</span>
<span>  determinandGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metals"</span>, <span class="st">"Organotins"</span>, <span class="st">"Organofluorines"</span><span class="op">)</span>, </span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metals"</span>, <span class="st">"Organotins"</span>, <span class="st">"Organofluorines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  symbology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      below <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, </span>
<span>      above <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, </span>
<span>      none <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  collapse_AC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>EAC <span class="op">=</span> <span class="st">"EQS"</span><span class="op">)</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">summary.dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sediment-assessment">Sediment assessment<a class="anchor" aria-label="anchor" href="#sediment-assessment"></a>
</h2>
<p>The sediment assessment is very similar, but has a few extra features
related to normalisation (to account for differences in grain size)
which are described below</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sediment_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span></span>
<span>  compartment <span class="op">=</span> <span class="st">"sediment"</span>,</span>
<span>  purpose <span class="op">=</span> <span class="st">"HELCOM"</span>,</span>
<span>  contaminants <span class="op">=</span> <span class="st">"sediment.txt"</span>,</span>
<span>  stations <span class="op">=</span> <span class="st">"stations.txt"</span>,</span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"data"</span>, <span class="st">"example_HELCOM"</span><span class="op">)</span>,</span>
<span>  info_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"information"</span>, <span class="st">"HELCOM_2023"</span><span class="op">)</span>,</span>
<span>  extraction <span class="op">=</span> <span class="st">"2023/08/23"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Found in path determinand.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv </span></span>
<span><span class="co">#&gt; Found in path species.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/species.csv </span></span>
<span><span class="co">#&gt; Found in path thresholds_sediment.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_sediment.csv </span></span>
<span><span class="co">#&gt; Found in package method_extraction.csv /Users/stuart/git/HARSAT/inst/information/method_extraction.csv </span></span>
<span><span class="co">#&gt; Found in package pivot_values.csv /Users/stuart/git/HARSAT/inst/information/pivot_values.csv </span></span>
<span><span class="co">#&gt; Found in package matrix.csv /Users/stuart/git/HARSAT/inst/information/matrix.csv </span></span>
<span><span class="co">#&gt; Found in package imposex.csv /Users/stuart/git/HARSAT/inst/information/imposex.csv </span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv': 'ed6c2f076d852976e23eab797bd16164'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/matrix.csv': '9ba2731a7d90accddac659025835a6e4'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/method_extraction.csv': 'b3c891f17b9b35774114edaa2f58b6cc'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/pivot_values.csv': '372ad2d2ef807cec64ce1a7bd1967158'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_sediment.csv': '52456c255f587a539177d5fa0fbb7cf1'</span></span>
<span><span class="co">#&gt; Reading station dictionary from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt': 'ada1ffa58215843e8e4d5f4d74f5e21e'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reading contaminant and effects data from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/sediment.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/sediment.txt': '0cd5fa2f4a07a2750a56a24b2fe887bf'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matching data with station dictionary</span></span>
<span><span class="co">#&gt;  - restricting to stations in these convention areas: HELCOM </span></span>
<span><span class="co">#&gt;  - no restriction of stations by data type</span></span>
<span><span class="co">#&gt;  - no restriction of stations by purpose of monitoring</span></span>
<span><span class="co">#&gt;  - no restriction of data by program governance</span></span>
<span><span class="co">#&gt;  - no restriction of stations by program governance</span></span>
<span><span class="co">#&gt;  - matching 6995 records by coordinates</span></span>
<span><span class="co">#&gt;  - matching 9365 records by station name</span></span>
<span><span class="co">#&gt;  - 15721 of 16360 records have been matched to a station</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Argument max_year taken to be the maximum year in the data: 2020</span></span>
<span></span>
<span><span class="va">sediment_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_data.html">tidy_data</a></span><span class="op">(</span><span class="va">sediment_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/sediment' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/sediment_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 2176 records from data flagged for deletion. Possible reasons are:</span></span>
<span><span class="co">#&gt;  - vflag = suspect</span></span>
<span><span class="co">#&gt;  - upper depth &gt; 0m</span></span>
<span><span class="co">#&gt;  - unusual matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 523 records from data that have no valid station code</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 13326 stations that are not associated with any data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning station dictionary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning contaminant and biological effects data</span></span></code></pre></div>
<p>The sediment data are grouped into time series which consist of the
measurements of single determinand in a single matrix (the fraction the
sample has been sieved to; e.g. <code>SED63</code> or
<code>SEDTOT</code>) at a single monitoring station.</p>
<p>The <code><a href="../reference/create_timeseries.html">create_timeseries()</a></code> call for sediment differs from
that for water in two ways. First, <code>determinands.control</code>
identifies two groups of determinands that need to be summed. Second,
the arguments <code>normalise</code> and <code>normalise.control</code>
specify how the normalisation for grain size should be carried out.
There are default functions for normalisation that will work in many
cases. However, the process for HELCOM is more complicated (because
unlike other metals, copper is normalised to organic carbon rather than
aluminium) so a customised function
<code><a href="../reference/normalise_sediment_HELCOM.html">normalise_sediment_HELCOM()</a></code> is provided. The argument
<code>normalise.control</code> specifies that metals (apart from copper)
will be normalised to 5% aluminium and copper and organics will be
normalised to 5% organic carbon. The normalise functions need a bit of
work, so expect them to change.</p>
<p>All contaminant time series in sediment are assessed on a dry weight
basis. The few measurements submitted on a wet weight basis are
converted to a dry weight basis using <code>DRYWT%</code> supporting
information (also submitted with the data).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sediment_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_timeseries.html">create_timeseries</a></span><span class="op">(</span></span>
<span>  <span class="va">sediment_data</span>,</span>
<span>  determinands.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    SBDE6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BDE28"</span>, <span class="st">"BDE47"</span>, <span class="st">"BDE99"</span>, <span class="st">"BD100"</span>, <span class="st">"BD153"</span>, <span class="st">"BD154"</span><span class="op">)</span>, </span>
<span>      action <span class="op">=</span> <span class="st">"sum"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    HBCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HBCDA"</span>, <span class="st">"HBCDB"</span>, <span class="st">"HBCDG"</span><span class="op">)</span>, action <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  normalise <span class="op">=</span> <span class="va">normalise_sediment_HELCOM</span>,</span>
<span>  normalise.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    metals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pivot"</span>, normaliser <span class="op">=</span> <span class="st">"AL"</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>    copper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"hybrid"</span>, normaliser <span class="op">=</span> <span class="st">"CORG"</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    organics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"simple"</span>, normaliser <span class="op">=</span> <span class="st">"CORG"</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/sediment' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/sediment_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning data</span></span>
<span><span class="co">#&gt;    Dropping stations with no data between 2015 and 2020 </span></span>
<span><span class="co">#&gt;    Dropping samples with only auxiliary variables</span></span>
<span><span class="co">#&gt;    Relabelling matrix SED62 as SED63 and SED500, SED1000, SED2000 as SEDTOT</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'basis': see basis_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'unit': see unit_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'value': see value_queries.csv</span></span>
<span><span class="co">#&gt;    Replicate measurements, only first retained: see replicate_measurements.csv</span></span>
<span><span class="co">#&gt;    Non-positive detection limits: see non_positive_det_limits.csv</span></span>
<span><span class="co">#&gt;    Non-positive quantification limits: see non_positive_quant_limits.csv</span></span>
<span><span class="co">#&gt;    Limit of quantification less than limit of detection: see limits_inconsistent.csv</span></span>
<span><span class="co">#&gt;    Censoring codes D and Q inconsistent with respective limits: see censoring_codes_inconsistent.csv</span></span>
<span><span class="co">#&gt;    Detection limit higher than data: see detection_limit_high.csv</span></span>
<span><span class="co">#&gt;    Non-positive uncertainties: see non_positive_uncertainties.csv</span></span>
<span><span class="co">#&gt;    Large uncertainties: see large_uncertainties.csv</span></span>
<span><span class="co">#&gt;    Data submitted as BDE28, BDE47, BDE99, BD100, BD153, BD154 summed to give </span></span>
<span><span class="co">#&gt; SBDE6</span></span>
<span><span class="co">#&gt;      61 of 124 samples lost due to incomplete submissions</span></span>
<span><span class="co">#&gt;    Data submitted as HBCDA, HBCDB, HBCDG summed to give HBCD</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Creating time series data</span></span>
<span><span class="co">#&gt;    Converting data to appropriate basis for statistical analysis</span></span>
<span><span class="co">#&gt;    Losing 6 out of 3282 records in basis conversion due to missing, censored</span></span>
<span><span class="co">#&gt;    or zero drywt or lipidwt values.</span></span>
<span><span class="co">#&gt;    Normalising copper to CORG using pivot values</span></span>
<span><span class="co">#&gt;    Removing sediment data where normaliser is a less than</span></span>
<span><span class="co">#&gt;    Normalising metals to AL using pivot values</span></span>
<span><span class="co">#&gt;    Normalising organics to 5% CORG</span></span>
<span><span class="co">#&gt;    Removing sediment data where normaliser is a less than</span></span>
<span><span class="co">#&gt;    Dropping groups of compounds / stations with no data between 2015 and 2020</span></span></code></pre></div>
<p>Now run the assessment. Again there is only one threshold, the EQS.
This only takes about a minute to run on my laptop.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sediment_assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_assessment.html">run_assessment</a></span><span class="op">(</span></span>
<span>  <span class="va">sediment_timeseries</span>, </span>
<span>  AC <span class="op">=</span> <span class="st">"EQS"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting up clusters: be patient, it can take a while!</span></span></code></pre></div>
<p>Everything has converged.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_assessment.html">check_assessment</a></span><span class="op">(</span><span class="va">sediment_assessment</span><span class="op">)</span></span>
<span><span class="co">#&gt; All assessment models have converged</span></span></code></pre></div>
<p>Finally, we can plot individual time series assessments (see vignette
for external data) or print out the summary table</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_summary_table.html">write_summary_table</a></span><span class="op">(</span></span>
<span>  <span class="va">sediment_assessment</span>,</span>
<span>  determinandGroups <span class="op">=</span> <span class="va">webGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metals"</span>, <span class="st">"Organotins"</span>, <span class="st">"PAH_parent"</span>, <span class="st">"PBDEs"</span>, <span class="st">"Organobromines"</span><span class="op">)</span>,  </span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Metals"</span>, <span class="st">"Organotins"</span>, <span class="st">"Polycyclic aromatic hydrocarbons"</span>,  </span>
<span>      <span class="st">"Organobromines"</span>, <span class="st">"Organobromines"</span> </span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  symbology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      below <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, </span>
<span>      above <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, </span>
<span>      none <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  collapse_AC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>EAC <span class="op">=</span> <span class="st">"EQS"</span><span class="op">)</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">summary.dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="biota-assessment">Biota assessment<a class="anchor" aria-label="anchor" href="#biota-assessment"></a>
</h2>
<p>The main difference in the biota assessment is the inclusion of
effects data. This example has some PAH metabolite time series, but all
imposex data have been excluded to keep things relatively simple.
Imposex assessments have an additional modelling stage and this will be
described in another vignette (not yet available).</p>
<p>The first two stages are just as before</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biota_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span></span>
<span>  compartment <span class="op">=</span> <span class="st">"biota"</span>, </span>
<span>  purpose <span class="op">=</span> <span class="st">"HELCOM"</span>,                               </span>
<span>  contaminants <span class="op">=</span> <span class="st">"biota.txt"</span>, </span>
<span>  stations <span class="op">=</span> <span class="st">"stations.txt"</span>, </span>
<span>  data_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"data"</span>, <span class="st">"example_HELCOM"</span><span class="op">)</span>,</span>
<span>  info_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working.directory</span>, <span class="st">"information"</span>, <span class="st">"HELCOM_2023"</span><span class="op">)</span>, </span>
<span>  extraction <span class="op">=</span> <span class="st">"2023/08/23"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Found in path determinand.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv </span></span>
<span><span class="co">#&gt; Found in path species.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/species.csv </span></span>
<span><span class="co">#&gt; Found in path thresholds_biota.csv /Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_biota.csv </span></span>
<span><span class="co">#&gt; Found in package method_extraction.csv /Users/stuart/git/HARSAT/inst/information/method_extraction.csv </span></span>
<span><span class="co">#&gt; Found in package pivot_values.csv /Users/stuart/git/HARSAT/inst/information/pivot_values.csv </span></span>
<span><span class="co">#&gt; Found in package matrix.csv /Users/stuart/git/HARSAT/inst/information/matrix.csv </span></span>
<span><span class="co">#&gt; Found in package imposex.csv /Users/stuart/git/HARSAT/inst/information/imposex.csv </span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/determinand.csv': 'ed6c2f076d852976e23eab797bd16164'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/matrix.csv': '9ba2731a7d90accddac659025835a6e4'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/species.csv': '895d4f259f2a1ee8d9c7ec52210f584c'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/inst/information/imposex.csv': '7e42cb57944b9d79216ad25c12ccada5'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/information/HELCOM_2023/thresholds_biota.csv': '1798bfbfb15104c2cbf8ff00ccf13abd'</span></span>
<span><span class="co">#&gt; Reading station dictionary from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/stations.txt': 'ada1ffa58215843e8e4d5f4d74f5e21e'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reading contaminant and effects data from:</span></span>
<span><span class="co">#&gt;  '/Users/stuart/git/HARSAT/data/example_HELCOM/biota.txt'</span></span>
<span><span class="co">#&gt; MD5 digest for: '/Users/stuart/git/HARSAT/data/example_HELCOM/biota.txt': 'a986e6899ecd6c9fbc0bd7854b452c9a'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matching data with station dictionary</span></span>
<span><span class="co">#&gt;  - restricting to stations in these convention areas: HELCOM </span></span>
<span><span class="co">#&gt;  - no restriction of stations by data type</span></span>
<span><span class="co">#&gt;  - no restriction of stations by purpose of monitoring</span></span>
<span><span class="co">#&gt;  - no restriction of data by program governance</span></span>
<span><span class="co">#&gt;  - no restriction of stations by program governance</span></span>
<span><span class="co">#&gt;  - matching 8644 records by coordinates</span></span>
<span><span class="co">#&gt;  - matching 19893 records by station name</span></span>
<span><span class="co">#&gt;  - 28437 of 28537 records have been matched to a station</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Argument max_year taken to be the maximum year in the data: 2020</span></span>
<span></span>
<span><span class="va">biota_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tidy_data.html">tidy_data</a></span><span class="op">(</span><span class="va">biota_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/biota' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/biota_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 32 records from data flagged for deletion. Possible reasons are:</span></span>
<span><span class="co">#&gt;  - vflag = suspect</span></span>
<span><span class="co">#&gt;  - species missing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 99 records from data that have no valid station code</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Dropping 13664 stations that are not associated with any data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning station dictionary</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning contaminant and biological effects data</span></span></code></pre></div>
<p>The construction of the time series has a few more features. However,
first we need to provide the individual TEQs to allow the construction
of the WHO TEQ for dioxins, furans and planar PCBS (labelled TEQDFP).
These are the values for the human health QS. This stage won’t be
necessary in later releases.</p>
<p>The biota data are grouped into time series which consist of the
measurements of a single determinand in a single matrix (tissue type;
e.g.  ‘EH’,
<code>LI' or</code>SB<code>) in a single species at a single monitoring station. PAH metabolite data are further grouped by</code>method_analysis`.</p>
<p>The <code>determinands.control</code> argument does rather more here.
There are four summed variables: PFOS, SBDE6, HBCD and SCB6. There is
also one variable CB138+163 which needs to be relabeled as (replaced by)
CB138. For the purposes of the assessment, the contribution of CB163 is
regarded as small. Similarly CB138+163 is taken to be a good proxy for
CB138. Note that the replacements must be done before the six PCBs are
summed to give SCB6 in order for them to be included in the sum.</p>
<p>There are also two ‘bespoke’ actions in
<code>determinands.control</code>. These are customised functions that
do more complicated things. One of them computes the WHO TEQ for
dioxins, furans and planar PCBS (labelled TEQDFP) using the TEFs for the
human health QS. The other deals with the three different ways in which
lipid weight measurements can be submitted.</p>
<p>Finally, <code><a href="../reference/normalise_biota_HELCOM.html">normalise_biota_HELCOM()</a></code> is a customised
function that determines which measurements are normalised to 5% lipid
in a HELCOM assessment. Again, the normalisation functions are under
active development and might well change before the next release.</p>
<p>One thing that is not obvious from the function call is the choice of
basis. By default, contaminant time series in biota are assessed on a
wet weight basis, with measurements submitted on a dry or lipid weight
basis transformed to a wet weight basis using supporting
<code>DRYWT%</code> and <code>LIPIDWT%</code> information. Look at the
OSPAR or external data examples to see how the choice of basis can be
changed.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biota_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_timeseries.html">create_timeseries</a></span><span class="op">(</span></span>
<span>  <span class="va">biota_data</span>,</span>
<span>  determinands.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    PFOS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N-PFOS"</span>, <span class="st">"BR-PFOS"</span><span class="op">)</span>, action <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span>,</span>
<span>    SBDE6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BDE28"</span>, <span class="st">"BDE47"</span>, <span class="st">"BDE99"</span>, <span class="st">"BD100"</span>, <span class="st">"BD153"</span>, <span class="st">"BD154"</span><span class="op">)</span>, </span>
<span>      action <span class="op">=</span> <span class="st">"sum"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    HBCD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HBCDA"</span>, <span class="st">"HBCDB"</span>, <span class="st">"HBCDG"</span><span class="op">)</span>, action <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span>,</span>
<span>    CB138 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="st">"CB138+163"</span>, action <span class="op">=</span> <span class="st">"replace"</span><span class="op">)</span>,</span>
<span>    SCB6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CB28"</span>, <span class="st">"CB52"</span>, <span class="st">"CB101"</span>, <span class="st">"CB138"</span>, <span class="st">"CB153"</span>, <span class="st">"CB180"</span><span class="op">)</span>, </span>
<span>      action <span class="op">=</span> <span class="st">"sum"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    TEQDFP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">info_TEF</span><span class="op">$</span><span class="va">DFP_human_health</span><span class="op">)</span>, </span>
<span>      action <span class="op">=</span> <span class="st">"bespoke"</span>, </span>
<span>      weights <span class="op">=</span> <span class="va">info_TEF</span><span class="op">$</span><span class="va">DFP_human_health</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">"LIPIDWT%"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>det <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EXLIP%"</span>, <span class="st">"FATWT%"</span><span class="op">)</span>, action <span class="op">=</span> <span class="st">"bespoke"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  normalise <span class="op">=</span> <span class="va">normalise_biota_HELCOM</span>,</span>
<span>  normalise.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    lipid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"simple"</span>, value <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>    other <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Oddities will be written to 'oddities/biota' with previous oddities backed up to</span></span>
<span><span class="co">#&gt;  'oddities/biota_backup'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cleaning data</span></span>
<span><span class="co">#&gt;    Dropping stations with no data between 2015 and 2020</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'species_group': see species_group_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'matrix': see matrix_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'basis': see basis_queries.csv</span></span>
<span><span class="co">#&gt;    Bile metabolite units changed from 'ng/g' to 'ng/ml' and from 'ug/kg' to 'ug/l'</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'unit': see unit_queries.csv</span></span>
<span><span class="co">#&gt;    Unexpected or missing values for 'value': see value_queries.csv</span></span>
<span><span class="co">#&gt;    Replicate measurements, only first retained: see replicate_measurements.csv</span></span>
<span><span class="co">#&gt;    Non-positive detection limits: see non_positive_det_limits.csv</span></span>
<span><span class="co">#&gt;    Non-positive quantification limits: see non_positive_quant_limits.csv</span></span>
<span><span class="co">#&gt;    Censoring codes D and Q inconsistent with respective limits: see censoring_codes_inconsistent.csv</span></span>
<span><span class="co">#&gt;    Detection limit higher than data: see detection_limit_high.csv</span></span>
<span><span class="co">#&gt;    Non-positive uncertainties: see non_positive_uncertainties.csv</span></span>
<span><span class="co">#&gt;    Large uncertainties: see large_uncertainties.csv</span></span>
<span><span class="co">#&gt;    Data submitted as BDE28, BDE47, BDE99, BD100, BD153, BD154 summed to give </span></span>
<span><span class="co">#&gt; SBDE6</span></span>
<span><span class="co">#&gt;      257 of 497 samples lost due to incomplete submissions</span></span>
<span><span class="co">#&gt;    Data submitted as HBCDA, HBCDB, HBCDG summed to give HBCD</span></span>
<span><span class="co">#&gt;      5 of 42 samples lost due to incomplete submissions</span></span>
<span><span class="co">#&gt;    Data submitted as CB138+163 relabelled as CB138 </span></span>
<span><span class="co">#&gt;    Data submitted as CB28, CB52, CB101, CB138, CB153, CB180 summed to give SCB6</span></span>
<span><span class="co">#&gt;      22 of 925 samples lost due to incomplete submissions</span></span>
<span><span class="co">#&gt;    Data submitted as </span></span>
<span><span class="co">#&gt; CB77, CB81, CB105, CB118, CB126, CB156, CB157, CB167, CB169, CDD1N, CDD4X, CDD6P, CDD6X, CDD9X, CDDO, CDF2N, CDF2T, CDF4X, CDF6P, CDF6X, CDF9P, CDF9X, CDFO, CDFP2, CDFX1, TCDD </span></span>
<span><span class="co">#&gt; summed to give TEQDFP</span></span>
<span><span class="co">#&gt;      907 of 945 samples lost due to incomplete submissions</span></span>
<span><span class="co">#&gt;    Data submitted as EXLIP% or FATWT% relabelled as LIPIDWT% </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Creating time series data</span></span>
<span><span class="co">#&gt;    Converting data to appropriate basis for statistical analysis</span></span>
<span><span class="co">#&gt;    Losing 63 out of 5737 records in basis conversion due to missing, censored</span></span>
<span><span class="co">#&gt;    or zero drywt or lipidwt values.</span></span>
<span><span class="co">#&gt;    Normalising lipid to 5%</span></span>
<span><span class="co">#&gt;    No normalisation for other</span></span>
<span><span class="co">#&gt;    Dropping groups of compounds / stations with no data between 2015 and 2020</span></span></code></pre></div>
<p>The asssessment took about 4.3 minutes on my laptop</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">biota_assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_assessment.html">run_assessment</a></span><span class="op">(</span></span>
<span>  <span class="va">biota_timeseries</span>, </span>
<span>  AC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BAC"</span>, <span class="st">"EAC"</span>, <span class="st">"EQS"</span>, <span class="st">"MPC"</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting up clusters: be patient, it can take a while!</span></span></code></pre></div>
<p>One time series has not converged. (The parameter estimates are fine,
but the standard errors are implausibly tight - if you look at the data,
you will see why the routines struggle with this time series.) The code
below tweaks the arguments of the numerical differencing routine that
calculates the standard errors. Dealing with non-converged timeseries is
a topic for a future vignette.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_assessment.html">check_assessment</a></span><span class="op">(</span><span class="va">biota_assessment</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following assessment models have not converged:</span></span>
<span><span class="co">#&gt; 2299 PYR1OH Limanda limanda BI HPLC-FD</span></span>
<span><span class="co">#&gt; 5844 CD Clupea harengus LI</span></span>
<span></span>
<span><span class="va">biota_assessment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_assessment.html">update_assessment</a></span><span class="op">(</span></span>
<span>  <span class="va">biota_assessment</span>, </span>
<span>  subset <span class="op">=</span> <span class="va">series</span> <span class="op">==</span> <span class="st">"2299 PYR1OH Limanda limanda BI HPLC-FD"</span>,</span>
<span>  hess.d <span class="op">=</span> <span class="fl">0.0001</span>, hess.r <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; assessing series:  station_code 2299; determinand PYR1OH; species Limanda limanda; matrix BI; method_analysis HPLC-FD; unit ng/ml</span></span>
<span></span>
<span><span class="fu"><a href="../reference/check_assessment.html">check_assessment</a></span><span class="op">(</span><span class="va">biota_assessment</span><span class="op">)</span></span>
<span><span class="co">#&gt; The following assessment models have not converged:</span></span>
<span><span class="co">#&gt; 5844 CD Clupea harengus LI</span></span></code></pre></div>
<p>And that’s it :)</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_summary_table.html">write_summary_table</a></span><span class="op">(</span></span>
<span>  <span class="va">biota_assessment</span>,</span>
<span>  determinandGroups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Metals"</span>, <span class="st">"PAH_parent"</span>, <span class="st">"Metabolites"</span>, <span class="st">"PBDEs"</span>, <span class="st">"Organobromines"</span>, </span>
<span>      <span class="st">"Organofluorines"</span>, <span class="st">"Chlorobiphenyls"</span>, <span class="st">"Dioxins"</span></span>
<span>    <span class="op">)</span>,  </span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Metals"</span>, <span class="st">"PAH compounds and metabolites"</span>, <span class="st">"PAH compounds and metabolites"</span>,</span>
<span>      <span class="st">"Organobromines"</span>, <span class="st">"Organobromines"</span>, <span class="st">"Organofluorines"</span>, </span>
<span>      <span class="st">"PCBs and dioxins"</span>, <span class="st">"PCBs and dioxins"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  symbology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      below <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, </span>
<span>      above <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EQS"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, </span>
<span>      none <span class="op">=</span> <span class="st">"black"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  collapse_AC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>EAC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAC"</span>, <span class="st">"EQS"</span>, <span class="st">"MPC"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">summary.dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/dataTables.bootstrap5.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script>
$('.datatable').dataTable();
</script>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arctic Monitoring and Assessment Programme (AMAP), Helsinki Commission (HELCOM), OSPAR Commission (OSPAR), International Council for the Exploration of the Sea (ICES), AmbieSense Ltd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p><a href="https://creativecommons.org/licenses/by/4.0/" class="external-link"><img class="cc-badge" src="http://mirrors.creativecommons.org/presskit/buttons/88x31/png/by.png"></a></p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
